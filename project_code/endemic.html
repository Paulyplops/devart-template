
<!DOCTYPE html>
<html>
<head>
<title>Experiment 1</title>
<script type="text/javascript" src="jquery-2.1.0.js"></script>
<script type="text/javascript" src="webgl-utils.js"></script>
<script type="text/javascript">


$(document).ready( function()
{
} );

$(window).load( function()
{
  var w = $(window).width();
  var h = $(window).height();

  $("#canvas").width( w );
  $("#canvas").height( h );
  var canvas = $('#canvas')[0];
  canvas.width = w;
  canvas.height = h;

  var gl = getWebGLContext(canvas);
  if (!gl) {
    return;
  }

  // setup GLSL program
  vertexShader = createShaderFromScriptElement(gl, "2d-vertex-shader");
  fragmentShader = createShaderFromScriptElement(gl, "2d-fragment-shader");
  program = createProgram(gl, [vertexShader, fragmentShader]);
  gl.useProgram(program);

  // look up where the vertex data needs to go.
  var positionLocation = gl.getAttribLocation(program, "a_position");

  var resolutionLocation = gl.getUniformLocation(program, "u_resolution");
  gl.uniform2f(resolutionLocation, canvas.width, canvas.height);

  // Set the colour in the fragment shader.
  var colorLocation = gl.getUniformLocation(program, "u_color");


  // Create a buffer and put a single clipspace rectangle in
  // it (2 triangles)
  var buffer = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
  gl.enableVertexAttribArray(positionLocation);
  gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);

  for( var x = 0; x < w - 50; x += 50 )
  {
    for( var y = 0; y < h - 50; y += 50 )
    {
      setRectangle( gl, x + 10, y + 10, 30, 30 );
      gl.uniform4f(colorLocation, Math.random(), Math.random(), Math.random(), 1);
      gl.drawArrays(gl.TRIANGLES, 0, 6);
    }
  }

});



// Fills the buffer with the values that define a rectangle.
function setRectangle(gl, x, y, width, height) {
  var x1 = x;
  var x2 = x + width;
  var y1 = y;
  var y2 = y + height;
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
     x1, y1,
     x2, y1,
     x1, y2,
     x1, y2,
     x2, y1,
     x2, y2]), gl.STATIC_DRAW);
}

// Returns a random integer from 0 to range - 1.
function randomInt(range) {
  return Math.floor(Math.random() * range);
}

</script>


<!-- vertex shader -->
<script id="2d-vertex-shader" type="x-shader/x-vertex">
attribute vec2 a_position;

uniform vec2 u_resolution;

void main() {


   // convert the rectangle from pixels to 0.0 to 1.0
   vec2 zeroToOne = a_position / u_resolution;

   // convert from 0->1 to 0->2
   vec2 zeroToTwo = zeroToOne * 2.0;

   // convert from 0->2 to -1->+1 (clipspace)
   vec2 clipSpace = zeroToTwo - 1.0;

   gl_Position = vec4( clipSpace * vec2(1, -1), 0, 1 );
}
</script>
<!-- fragment shader -->
<script id="2d-fragment-shader" type="x-shader/x-fragment">
precision mediump float;

uniform vec4 u_color;

void main() {
   gl_FragColor = u_color;
}
</script>



    <style type="text/css">
      canvas { 
        border: 0px; 
      }
      html,body, canvas {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="200px" height="200px"></canvas>
  </body>
</html>
